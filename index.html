<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Gratitude 2025 | Centre for Social Action üéÑ</title>

    <!-- Firebase -->
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Caveat:wght@400;600&family=Playfair+Display:wght@500;600&display=swap" rel="stylesheet">

    <style>
         :root {
            --glass: rgba(255, 255, 255, .18);
            --blur: blur(28px);
        }
        /* RESET */
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0
        }
        
        body {
            min-height: 100vh;
            background: radial-gradient(1200px 600px at top, rgba(255, 255, 255, .08), transparent 60%), linear-gradient(180deg, #050b1f, #0b2540);
            color: #fff;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            overflow: hidden;
            font-family: "Playfair Display", serif;
        }
        /* SNOW */
        
        .snow {
            position: fixed;
            top: -10px;
            pointer-events: none;
            animation: fall linear infinite;
        }
        
        @keyframes fall {
            to {
                transform: translateY(110vh)
            }
        }
        /* CARD */
        
        .card {
            max-width: 580px;
            width: 100%;
            padding: 42px 36px;
            border-radius: 30px;
            background: linear-gradient(180deg, rgba(255, 255, 255, .24), rgba(255, 255, 255, .05));
            backdrop-filter: var(--blur) saturate(160%);
            border: 1px solid var(--glass);
            box-shadow: 0 45px 90px rgba(0, 0, 0, .5);
            text-align: center;
            animation: fadeUp .7s ease both;
        }
        
        @keyframes fadeUp {
            from {
                opacity: 0;
                transform: translateY(18px)
            }
            to {
                opacity: 1;
                transform: none
            }
        }
        /* FLOW */
        
        .flow {
            font-size: .7rem;
            letter-spacing: 2px;
            text-transform: uppercase;
            opacity: .7;
            margin-bottom: 18px;
        }
        /* TEXT */
        
        h1 {
            margin-bottom: 12px
        }
        
        .subtitle {
            font-size: .95rem;
            line-height: 1.65;
            opacity: .9;
            margin-bottom: 28px;
        }
        /* INPUTS */
        
        input,
        textarea {
            width: 100%;
            border-radius: 20px;
            border: 1px solid rgba(255, 255, 255, .25);
            padding: 16px 18px;
            font-size: 1rem;
            background: rgba(255, 255, 255, .15);
            color: #fff;
            outline: none;
            margin-bottom: 14px;
        }
        
        textarea {
            min-height: 150px;
            resize: none
        }
        /* BUTTONS */
        
        button {
            width: 100%;
            padding: 16px;
            border-radius: 24px;
            border: none;
            cursor: pointer;
            font-weight: 600;
            background: linear-gradient(180deg, #fff, #e7e7e7);
            color: #1a1a1a;
            margin-top: 12px;
            transition: transform .25s ease, box-shadow .25s ease;
        }
        
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 18px rgba(0, 0, 0, .25);
        }
        
        button.drop {
            animation: drop .6s ease forwards
        }
        
        @keyframes drop {
            to {
                transform: translateY(80px);
                opacity: 0
            }
        }
        /* LETTER */
        
        .preview,
        .envelope-stage,
        .seal-stage,
        .success {
            display: none
        }
        
        .letter {
            background: radial-gradient(circle at 20% 30%, rgba(139, 69, 19, .18), transparent 40%), radial-gradient(circle at 70% 60%, rgba(160, 82, 45, .15), transparent 45%), linear-gradient(180deg, #f7ead1, #e4d1a3);
            color: #4b2e1e;
            padding: 34px 30px;
            border-radius: 16px;
            font-family: "Caveat", cursive;
            font-size: 1.25rem;
            line-height: 1.7;
            margin-bottom: 18px;
            box-shadow: 0 22px 40px rgba(0, 0, 0, .35);
            position: relative;
        }
        
        .letter::after {
            content: "";
            position: absolute;
            inset: 0;
            background-image: url("https://www.transparenttextures.com/patterns/paper-fibers.png");
            opacity: .35;
            pointer-events: none;
        }
        
        .to {
            font-weight: 600;
            margin-bottom: 16px
        }
        
        .signature {
            margin-top: 30px;
            text-align: right;
            font-size: .9rem;
            opacity: .8;
            font-family: "Playfair Display", serif;
        }
        /* ENVELOPE */
        
        .envelope {
            width: 260px;
            height: 170px;
            background: linear-gradient(180deg, #ead8b8, #d6c2a0);
            margin: 0 auto 26px;
            border-radius: 14px;
            position: relative;
            animation: closeEnv .9s ease forwards;
        }
        
        .envelope::before {
            content: "";
            position: absolute;
            inset: 0;
            height: 55%;
            background: linear-gradient(180deg, #d2b48c, #c3a77b);
            clip-path: polygon(0 0, 100% 0, 50% 100%);
        }
        
        @keyframes closeEnv {
            from {
                transform: scale(1.06)
            }
            to {
                transform: scale(1)
            }
        }
        
        .seal {
            width: 54px;
            height: 54px;
            background: #8b1e1e;
            border-radius: 50%;
            margin: -28px auto 10px;
            box-shadow: 0 6px 14px rgba(0, 0, 0, .4);
        }
        /* SUCCESS */
        
        .success h1 {
            margin-bottom: 10px
        }
    </style>
</head>

<body>

    <!-- FORM -->
    <div class="card" id="formBox">
        <div class="flow"> Centre for Social Action</div>
        <h1>üéÑ Gratitude 2025</h1>
        <p class="subtitle">
            Gratitude is noticing the little things‚Äîthe quiet help, the unexpected smiles, the moments that warm your heart without asking for attention.
        </p>

        <input id="recipient" placeholder="Who are you grateful for?[Enter the full name]" />
        <textarea id="message" placeholder="Write your gratitude here‚Ä¶"></textarea>

        <button onclick="showPreview()">Preview Letter üëÄ</button>
    </div>

    <!-- PREVIEW -->
    <div class="card preview" id="previewBox">
        <div class="flow">Centre for Social Action</div>
        <div class="letter">
            <div class="to" id="pTo"></div>
            <div id="pMessage"></div>
            <div class="signature">‚Äî Centre for Social Action</div>
        </div>
        <button onclick="backToEdit()">‚úèÔ∏è Edit</button>
        <button id="finalSend" onclick="sendFinal()">‚úâÔ∏è Drop Letter</button>
    </div>

    <!-- ENVELOPE -->
    <div class="card envelope-stage" id="envelopeBox">
        <div class="envelope"></div>
        <p>Your letter is gently placed inside the envelope‚Ä¶</p>
    </div>

    <!-- SEAL -->
    <div class="card seal-stage" id="sealBox">
        <div class="envelope"></div>
        <div class="seal"></div>
        <p>Your gratitude has been sealed with care.</p>
    </div>

    <!-- SUCCESS -->
    <div class="card success" id="successBox">
        <h1>ü§ç Thank You</h1>
        <p class="subtitle">
            Your gratitude now becomes part of the Centre for Social Action story.
        </p>
    </div>

    <script>
        firebase.initializeApp({
            apiKey: "AIzaSyAfg-H64wDdxB4NOpfSDVzY9z-iUxaT7gI",
            authDomain: "csa-christmas-gratitude.firebaseapp.com",
            projectId: "csa-christmas-gratitude"
        });
        const db = firebase.firestore();

        function showPreview() {
            if (!recipient.value || !message.value) return alert("Please fill all fields ü§ç");
            formBox.style.display = "none";
            previewBox.style.display = "block";
            pTo.textContent = "To: " + recipient.value;
            pMessage.textContent = message.value;
        }

        function backToEdit() {
            previewBox.style.display = "none";
            formBox.style.display = "block";
        }
        async function sendFinal() {
            finalSend.classList.add("drop");
            await db.collection("messages").add({
                recipient: recipient.value,
                message: message.value,
                createdAt: firebase.firestore.FieldValue.serverTimestamp()
            });
            setTimeout(() => {
                previewBox.style.display = "none";
                envelopeBox.style.display = "block"
            }, 600);
            setTimeout(() => {
                envelopeBox.style.display = "none";
                sealBox.style.display = "block"
            }, 1700);
            setTimeout(() => {
                sealBox.style.display = "none";
                successBox.style.display = "block"
            }, 3000);
        }

        /* SNOW */
        for (let i = 0; i < 40; i++) {
            const s = document.createElement("div");
            s.className = "snow";
            s.textContent = "‚ùÑ";
            s.style.left = Math.random() * 100 + "vw";
            s.style.animationDuration = (Math.random() * 6 + 4) + "s";
            s.style.opacity = Math.random();
            document.body.appendChild(s);
        }
    </script>

</body>

</html>